<!--Добавление и поиск-->
<div class="wrapper">
  <a class="join" href="{{thisUrl}}#popupAdd" (click)="addBook()">
    <a class="joinsign">Добавить книгу</a>
  </a>
  <div class="search">
    <form action="" class="sline">
      <input [(ngModel)]="str" (input)="findBook(str)" name="findBook" type="text" placeholder="Поиск">
    </form>
  </div>
</div>

<!--Таблица-->
  <app-table
  [headings]="['Название', 'Автор', 'Жанр', 'Кол-во', 'В наличии', 'Комментарии', 'Редактировать', 'Удалить']"
  [objectKeys]="['bookName', 'bookAuthor', 'bookGenre', 'bookCount', 'bookInStock']"
  [arrayObects]="books"
  [trNgClassBoolean]="checkCount"
  [popupComment]="true"
  [popupEdit]="true"
  [popupDelete]="true"
  (object)="touchBook($event)"
  >
  </app-table>


<!--Попап Добавления-->
<div id="popupAdd" class="overlay">
  <div class="popup">
    <a class="close" href="{{thisUrl}}#">&times;</a>
    <div class="content">
      <form class="decor" novalidate [formGroup]="bookForm" (ngSubmit)="submitBookAdd(); clickHref()">
        <div class="form-left-decoration"></div>
        <div class="form-right-decoration"></div>
        <div class="form-inner">
          <h3>Добавить книгу</h3>
          <input formControlName="bookName" placeholder="Название книги"/>
          <input formControlName="bookAuthor" placeholder="Автор (Фамилия + Имя)"/>
          <input formControlName="bookGenre" placeholder="Жанр"/>
          <label for="count">Количество</label>
          <input id="count" type="number" min="1" formControlName="bookCount" placeholder="Количество"/>
          <button
            [disabled]="bookForm.invalid"
            [ngClass]="{formButtonInval: bookForm.invalid, formButtonVal: bookForm.valid}">Добавить
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<!--Попап Редактирования-->
<div id="popupEdit" class="overlay">
  <div class="popup">
    <a class="close" href="{{thisUrl}}#">&times;</a>
    <div class="content">
      <form class="decor" novalidate [formGroup]="bookForm" (ngSubmit)="submitBookEdit(); clickHref()">
        <div class="form-left-decoration"></div>
        <div class="form-right-decoration"></div>
        <div class="form-inner">
          <h3>Изменить книгу</h3>
          <input  disabled [placeholder]="touchBookObj.bookName"/>
          <input  disabled [placeholder]="touchBookObj.bookAuthor"/>
          <input  formControlName="bookGenre" placeholder="Жанр"/>
          <label for="bookCountEdit">Количество:</label>
          <input id="bookCountEdit" type="number" min="1" formControlName="bookCount" placeholder="Количество"/>
          <label for="bookInStockEdit">В наличии:</label>
          <input id="bookInStockEdit" type="number" min="0" [max]="bookForm.controls.bookCount.value" formControlName="bookInStock" placeholder="В наличии"/>
          <button
            [disabled]="bookForm.invalid"
            [ngClass]="{formButtonInval: bookForm.invalid, formButtonVal: bookForm.valid}">Изменить
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<!--Попап Удаления-->
<div id="popupDelete" class="overlay">
  <div class="popup">
    <a class="close" href="{{thisUrl}}#">&times;</a>
    <div class="content">
      <form class="decor" novalidate [formGroup]="bookForm" (ngSubmit)="submitBookDel(); clickHref()">
        <div class="form-left-decoration"></div>
        <div class="form-right-decoration"></div>
        <div class="form-inner">
          <h3>Удалить книгу</h3>
          <input  disabled [placeholder]="touchBookObj.bookName"/>
          <input  disabled [placeholder]="touchBookObj.bookAuthor"/>
          <input readonly formControlName="bookGenre" placeholder="Жанр"/>
          <label for="bookCountDelete">Количество:</label>
          <input id="bookCountDelete" readonly formControlName="bookCount" placeholder="Количество"/>
          <label for="bookInStockDelete">В наличии:</label>
          <input id="bookInStockDelete" readonly formControlName="bookInStock" placeholder="В наличии"/>
          <button class="del">Удалить
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<!--Попап Комментариев (Добавление)-->
<div id="popupComment" class="overlay">
  <div class="popup popupComm">
    <a class="close" href="{{thisUrl}}#">&times;</a>

    <div class="contentComment">

      <div class="divLeftPopComment">

        <div class="ComName">{{touchBookObj.bookName}}</div>
        <div class="ComAuthor">({{touchBookObj.bookAuthor}})</div>

        <cdk-virtual-scroll-viewport itemSize="10" class="virtual-scroll-comment">

          <div *cdkVirtualFor="let comment of comments">
            <div *ngIf="comment.bookKey === touchBookObj.key" class="container">
              <div class="piccont">
                <div class="pic">
                  <div class="picsign">
                    {{comment.userLastName[0]}}
                  </div>
                </div>
              </div>

              <div>
                <div class="btnComm">
                  <a (click)="commentEdit(comment)" class="buttonEdit">Ред</a>
                  <a (click)="buttonDelete(comment)" class="buttonDel">Уд</a>
                </div>
                <p class="userComName">{{comment.userName}} {{comment.userLastName}}</p>
                <p class="userComDisc">{{comment.userComment}}</p>
              </div>
            </div>
          </div>
        </cdk-virtual-scroll-viewport>

      </div>


      <div *ngIf="addEditSwitch" class="divRightPopComment">
        <form class="formCom" [formGroup]="bookCommentForm" novalidate (ngSubmit)="submitComentAdd()">
          <div class="form-group">
            <div class="userComDiscCenter">Добавить комментарий</div>
            <textarea class="textareaCom" formControlName="userComment"></textarea>
          </div>
          <div class="form-group">
            <button
              [disabled]="bookCommentForm.invalid"
              [ngClass]="{formButtonInval: bookCommentForm.invalid, formButtonVal: bookCommentForm.valid}">Добавить
            </button>
          </div>
        </form>
      </div>

      <div *ngIf="addEditSwitch === false" class="divRightPopComment">
        <form class="formCom" [formGroup]="bookCommentForm" novalidate (ngSubmit)="submitComentEdit()">
          <div class="form-group">
            <div class="userComDiscCenter">Изменить комментарий</div>
            <textarea class="textareaCom" formControlName="userComment"></textarea>
          </div>
          <div class="form-group">
            <button
              [disabled]="bookCommentForm.invalid"
              [ngClass]="{formButtonInval: bookCommentForm.invalid, formButtonVal: bookCommentForm.valid}">Изменить
            </button>
          </div>
        </form>
      </div>


    </div>
  </div>
</div>



