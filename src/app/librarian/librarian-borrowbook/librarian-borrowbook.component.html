<!--Добавление и поиск-->
<div class="wrapper">
  <a class="join" (click)="resetForm()" href="{{thisUrl}}#popupAdd">
    <a class="joinsign">Арендовать книгу</a>
  </a>

  <div class="search">
    <form action="" class="sline">
      <input [(ngModel)]="strSearch" name="findBook" type="text" placeholder="Поиск"
             (input)="findBorrowBook(strSearch)">
    </form>
  </div>
</div>


<!--Таблица-->
<!--<div class="TableUser">-->
<!--  <cdk-virtual-scroll-viewport itemSize="10" class="virtual-scroll">-->
<!--    <table>-->
<!--      <tr>-->
<!--        <th>Фамилия</th>-->
<!--        <th>Имя</th>-->
<!--        <th>Название книги</th>-->
<!--        <th>Автор</th>-->
<!--        <th>Дата взятия</th>-->
<!--        <th>Дата<br>(ожидаемого)<br>возврата</th>-->
<!--        <th>Ред</th>-->
<!--        <th>Уд</th>-->
<!--        <th>Возврат</th>-->
<!--      </tr>-->


<!--      <tr *cdkVirtualFor="let borrowBook of borrowBooks" TableTouch-->
<!--          [ngClass]="{-->
<!--        returnBaclground: borrowBook.returnBookCheck,-->
<!--        NOreturnBaclground: borrowBook.date.returnBookDate < today && !borrowBook.returnBookCheck-->
<!--         }">-->

<!--        <td>{{borrowBook.studLastName}}</td>-->
<!--        <td>{{borrowBook.studName}}</td>-->
<!--        <td>{{borrowBook.bookName}}</td>-->
<!--        <td>{{borrowBook.bookAuthor}}</td>-->
<!--        <td>{{borrowBook.borrowBookDate | date:"dd.MM.yyyy"}}</td>-->
<!--        <td>{{borrowBook.returnBookDate | date:"dd.MM.yyyy"}}</td>-->


<!--        <td class="btn" (click)="clickHref('#popupEdit'); dataBorrowBook(borrowBook)">-->
<!--          <a class="buttonEdit">Ред</a>-->
<!--        </td>-->

<!--        <td class="btn" (click)="clickHref('#popupDelete'); dataBorrowBook(borrowBook)">-->
<!--          <a class="buttonDel">Уд</a>-->
<!--        </td>-->

<!--        <td class="btn">-->
<!--          <label class="switch">-->
<!--            <input type="checkbox"-->
<!--                   [disabled]="checkCountBook(borrowBook)"-->
<!--                   [checked]="borrowBook.returnBookCheck"-->
<!--                   (click)="returnBookCheck(borrowBook)">-->
<!--            <span class="slider round"></span>-->
<!--          </label>-->
<!--        </td>-->

<!--      </tr>-->
<!--    </table>-->
<!--  </cdk-virtual-scroll-viewport>-->
<!--</div>-->


<app-table
  [headings]="['Фамилия', 'Имя', 'Название книги', 'Автор', 'Дата взятия' ,'Дата (ожидаемого) возврата','Редактировать', 'Удалить', 'Возврат']"
  [objectKeys]="['studLastName', 'studName', 'bookName', 'bookAuthor', 'borrowBookDate', 'returnBookDate']"
  [arrayObects]="borrowBooks"
  [trNgClassBoolean]="checkFn"
  [popupEdit]="true"
  [popupDelete]="true"
  [buttonSwitch]="true"
  [checkStock]="checkStock"
  (object)="touchBorrowBook($event)"
  (objectSwitch)="touchSwitch($event)"
>
</app-table>


<div id="popupAdd" class="overlay">
  <div class="popup">
    <a class="close" href="{{thisUrl}}#">&times;</a>
    <div class="content">
      <form class="decor" novalidate [formGroup]="borrowBookForm">
        <div class="form-left-decoration"></div>
        <div class="form-right-decoration"></div>
        <div class="form-inner">
          <h3>Добавить бронь книги</h3>
          <label>Студент: </label>
          <select formControlName="studKey" class="selInput">
            <option *ngFor="let student of students" [value]="student.key">
              <p>{{student.userName}} {{student.userLastName}}</p>
            </option>
          </select>
          <label>Книга: </label>
          <select formControlName="bookKey" class="selInput">
            <ng-container *ngFor="let book of books">
              <option *ngIf="book.bookInStock > 0" [value]="book.key">
                <p>{{book.bookName}} ({{book.bookAuthor}})</p>
              </option>
            </ng-container>
          </select>
          <label>Дата взятие книги: </label>
          <input formControlName="borrowBookDate" type="date">
          <label>Дата возврата книги: </label>
          <input formControlName="returnBookDate" type="date">
          <button class="mgTop" (click)="AddBorrowBook()" [disabled]="borrowBookForm.invalid"
                  [ngClass]="{formButtonInval: borrowBookForm.invalid, formButtonVal: borrowBookForm.valid}">Добавить
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<div id="popupEdit" class="overlay">
  <div class="popup">
    <a class="close" href="{{thisUrl}}#">&times;</a>
    <div class="content">
      <form class="decor" novalidate [formGroup]="borrowBookForm" (ngSubmit)="EditBorrowBook()">

        <div class="form-left-decoration"></div>
        <div class="form-right-decoration"></div>
        <div class="form-inner">

          <h3>Изменить бронь книги</h3>


          <input readonly type="text" [value]="borrowBookForm.value['studName']
            + ' ' + borrowBookForm.value['studLastName']">

          <input readonly type="text" [value]="borrowBookForm.value['bookName']
            + ' ' + '(' + borrowBookForm.value['bookAuthor']  + ')'">

          <label for="borrowBookDateEdit">Взял книгу:</label>
          <input id="borrowBookDateEdit" formControlName="borrowBookDate" type="date">

          <label for="returnBookDateEdit">Вернул книгу:</label>
          <input id="returnBookDateEdit" formControlName="returnBookDate" type="date">


          <button
            [disabled]="borrowBookForm.invalid"
            [ngClass]="{formButtonInval: borrowBookForm.invalid, formButtonVal: borrowBookForm.valid}">Изменить
          </button>

        </div>
      </form>
    </div>
  </div>
</div>

<div id="popupDelete" class="overlay">
  <div class="popup">
    <a class="close" href="{{thisUrl}}#">&times;</a>
    <div class="content">
      <form class="decor" novalidate [formGroup]="borrowBookForm" (ngSubmit)="DeleteBorrowBook()">
        <div class="form-left-decoration"></div>
        <div class="form-right-decoration"></div>
        <div class="form-inner">
          <h3>Удалить бронь книги</h3>
          <input readonly type="text" [value]="borrowBookForm.value['studName']
            + ' ' + borrowBookForm.value['studLastName']">
          <input readonly type="text" [value]="borrowBookForm.value['bookName']
            + ' ' + '(' + borrowBookForm.value['bookAuthor']  + ')'">
          <label for="borrowBookDateDelete">Взял книгу</label>
          <input id="borrowBookDateDelete" readonly type="date" [value]="borrowBookForm.value['borrowBookDate']">
          <label for="returnBookDateDelte">Вернул книгу</label>
          <input id="returnBookDateDelte" readonly type="date" [value]="borrowBookForm.value['returnBookDate']">
          <input  readonly type="text" [value]="borrowBookForm.value['returnBookCheck'] ? 'Вернул книгу' : 'Не вернул книгу' ">
          <button class="del">Удалить</button>
        </div>
      </form>
    </div>
  </div>
</div>
